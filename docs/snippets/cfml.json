{
    "cf_admin": {
      "prefix": "admin",
      "body": [
        "<cf_admin table_name=\"${1}\" fields_in_list=\"${2}\" fields_to_edit=\"${3}\">",
        "",
        "</cf_admin>"
      ],
      "description": "cf_admin"
    },
    "Alpine.data": {
        "prefix": "alpine.data",
        "body": [
            "<div x-data=\"$1\">",
            "    ",
            "</div>",
            "",
            "<script>",
            "    document.addEventListener(\"alpine:init\", () => {",
            "        Alpine.data(\"$1\", () => ({",
            "            init(){",
            "                // do something",
            "            },",
            "        }))",
            "    })",
            "</script>"
        ],
        "description": "Alpine.data"
    },
    "alpinejs template x-for": {
      "prefix": "alpine.template",
      "body": [
        "<template x-for=\"(${1}, i) in ${2}\" :key=\"${1}.id\">",
        "   ",
        "</template>"
      ],
      "description": "alpinejs template x-for..."
    },
    "bs_field": {
      "prefix": "bs_field",
      "body": [
        "<div class=\"mb-3\">",
        "    <label class=\"form-label mb-0 fw-bold\" for=\"$1\">$2</label>",
        "    <input type=\"text\" class=\"form-control\" placeholder=\"\" x-model=\"$3\" id=\"$1\">",
        "</div>"
      ],
      "description": "bs_field"
    },
    "bs_table:fixed": {
      "prefix": "bs_table:fixed",
      "body": [
        "<table class=\"table table-sm table-hover\" style=\"table-layout:fixed\">",
        "<colgroup>",
        "    <col style=\"width:60px;\">",
        "    <col style=\"\">",
        "</colgroup>",
        "<thead>",
        "    <tr>",
        "        <th></th>",
        "        <th></th>",
        "    </tr>",
        "</thead>",
        "<tbody>",
        "    <template x-for=\"(${1}, i) in ${2}\" :key=\"${1}.id\">",
        "        <tr role=\"button\">",
        "            <td></td>",
        "            <td></td>",
        "        </tr>",
        "    </template>",
        "</tbody>",
        "</table>"
      ],
      "description": "bs_table:fixed"
    },
    "endpoint": {
      "prefix": "endpoint",
      "body": [
        "<cffunction name=\"$1\">",
        "",
        "    <cfreturn = {} />",
        "",
        "</cffunction>"
      ],
      "description": "endpoint",
    },
    "endpoint.delete": {
      "prefix": "endpoint.delete",
      "body": [
        "<cffunction name=\"delete\">",
        "    <cfparam name=\"url.id\" type=\"guid\" />",
        "    <cfreturn application.lib.db.delete(table_name=\"$1\", id=\"#url.id#\") />",
        "</cffunction>"
      ],
      "description": "endpoint delete"
    },
    "endpoint.new": {
      "prefix": "endpoint.new",
      "body": [
        "<cffunction name=\"addNew\">",
        "    <cfreturn application.lib.db.save( \"$1\"  ) />",
        "</cffunction>"
      ],
      "description": "endpoint new"
    },
    "endpoint.save": {
      "prefix": "endpoint.save",
      "body": [
        "<cffunction name=\"save\">",
        "    <cfreturn application.lib.db.save(",
        "        table_name = \"$1\",",
        "        data = request.data",
        "    ) />",
        "</cffunction>"
      ],
      "description": "endpoint save"
    },
    "endpoint.search": {
      "prefix": "endpoint.search",
      "body": [
        "<cffunction name=\"search\">",
        "    <cfreturn application.lib.db.search(table_name='$1', q=\"#url.q?:''#\") />",
        "</cffunction>"
      ],
      "description": "endpoint search"
    },

    "endpoint.search.advanced": {
        "prefix": "endpoint.search.advanced",
        "body": [
            "<cffunction name=\"search\">",
            "",
            "    <cfquery name=\"q\">",
            "    SELECT COALESCE(jsonb_agg(data)::text, '[]') as data",
            "    FROM (",
            "            SELECT #application.lib.db.select(table_name='$1', field_list='')#",
            "            FROM $1",
            "            WHERE 1=1",
            "",
            "            <cfif len(url.q?:'')>",
            "                <cfset search_ids = application.lib.db.idsInSearchTerm('$1', url.q) />",
            "                AND $1.id in (<cfqueryparam cfsqltype=\"other\" list=\"true\" value=\"#search_ids#\" />)",
            "            </cfif>",
            "",
            "    ) as data",
            "    </cfquery>",
            "",
            "    <cfif len(search_ids?:'')>",
            "        <cfreturn application.lib.db.sortRecordsetByIds(recordset=q.data, ids=search_ids) />",
            "    </cfif>",
            "",
            "    <cfreturn q.data />",
            "",
            "</cffunction>"
        ],
        "description": "Advanced endpoint search with sorting"
    },

    "application.lib.db": {
      "prefix": "application.lib.db",
      "body": [
        "application.lib.db.${1}(${2})"
      ],
      "description": "application.lib.db.fn()"
    },
    "cf_modal": {
      "prefix": "cf_modal",
      "body": [
        "<button type=\"button\" class=\"btn btn-outline-primary\" @click=\"show_${1}\">Show ${1}</button>",
        "",
        "<cf_modal id=\"modal_${1}\" title=\"Edit ${1}\" size=\"modal-xl\">",
        "    ",
        "    MODAL BODY",
        "",
        "    <cf_fragment slot=\"actions\">",
        "        <button class=\"btn btn-primary\" @click=\"save_${1}\">Save</button>",
        "    </cf_fragment>",
        "</cf_modal>",
        "",
        "",
        "show_${1}() {",
        "    bootstrap.Modal.getInstance(this.$refs.modal_${1}).show()",
        "},",
        "",
        "async save_${1}() {",
        "    this.loadingState = 'loading';",
        "",
        "    const data = await fetchData({",
        "        method: 'POST',",
        "        action: 'save__${1}',",
        "        body: {},",
        "        callback: (data) => {",
        "            this.loadingState = 'idle';",
        "            bootstrap.Modal.getInstance(this.$refs.modal_${1}).hide()",
        "            return data",
        "        }",
        "    });",
        "},"
      ],
      "description": "cf_modal"
    },
    "moo_input": {
      "prefix": "moo_input",
      "body": [
        "<cfif thisTag.executionMode EQ \"start\">",
        "",
        "    <cfoutput>",
        "        <div",
        "            x-data=\"${1}\"",
        "            class=\"mb-3\"",
        "            x-id=\"['input_id']\"",
        "        >",
        "",
        "            <cfif len(attributes.model?:'')>",
        "                <input",
        "                    type=\"hidden\"",
        "                    x-modelable=\"value\"",
        "                    x-model#(attributes.modifiers?:'')#=\"#(attributes.model?:'')#\"",
        "                />",
        "            </cfif>",
        "",
        "            <cfif len(attributes.label)>",
        "                <label :for=\"\\$\\$id('input_id')\" class=\"form-label mb-0 fw-bold\">#attributes.label?:''#</label>",
        "            </cfif>",
        "",
        "            <input",
        "                :id=\"\\$\\$id('input_id')\"",
        "                type=\"text\"",
        "                class=\"form-control\"",
        "                placeholder=\"#attributes.placeholder?:''#\"",
        "                autocapitalize=\"off\" autocomplete=\"off\" autocorrect=\"off\"",
        "                x-model=\"value\"",
        "            >",
        "        </div>",
        "",
        "        <cf_once id=\"${1}_script\">",
        "            <script>",
        "            document.addEventListener(\"alpine:init\", () => {",
        "                Alpine.data(\"${1}\", () => ({",
        "                    value: null",
        "                }))",
        "            })",
        "            </script>",
        "        </cf_once>",
        "    </cfoutput>",
        "",
        "<cfelseif thisTag.executionMode EQ \"end\">",
        "    <!--- not required --->",
        "</cfif>"
      ],
      "description": "moo_input"
    },
    "query_jsonb_agg": {
      "prefix": "query_jsonb_agg",
      "body": [
        "<cfquery name=\"q\">",
        "SELECT COALESCE(jsonb_agg(data)::text, '[]') as data",
        "FROM (",
        "        SELECT ${1}.*",
        "        FROM ${1}",
        ") as data",
        "</cfquery>"
      ],
      "description": "query_jsonb_agg"
    },
    "query_row_to_json": {
      "prefix": "query_row_to_json",
      "body": [
        "<cfquery name=\"q\">",
        "SELECT COALESCE(row_to_json(data)::text, '{}') as data",
        "FROM (",
        "        SELECT ${1}.*",
        "        FROM ${1}",
        ") as data",
        "</cfquery>"
      ],
      "description": "query_row_to_json"
    },

    "query_using_schema": {
        "prefix": "query_using_schema",
        "description": "Create a PostgreSQL query that returns JSON using schema functions",
        "body": [
        "<cfquery name=\"${1:jsonData}\">",
        "\tSELECT COALESCE(array_to_json(array_agg(row_to_json(data)))::text, '[]') AS recordset",
        "\tFROM (",
        "\t\tSELECT #select(table_name=\"${2:table_name}\", field_list=\"${3:*}\")#",
        "\t\tFROM \"${2:table_name}\"",
        "\t\tWHERE 1 = 1",
        "\t\t${4:-- Additional conditions here}",
        "\t\t#orderby(table_name=\"${2:table_name}\")#",
        "\t\tLIMIT ${5:100}",
        "\t) AS data",
        "</cfquery>",
        "<cfset ${6:aData} = deserializeJSON(${1:jsonData}.recordset) >"
        ]
    },
        "route_simple": {
          "prefix": "route_simple",
          "body": [
            "<cfcomponent key=\"${1:key}\">",
            "",
            "    <cffunction name=\"read\">",
            "        <cfreturn application.lib.db.read(table_name='${2:table_name}', id=\"#url.id#\", field_list=\"*\", returnAsCFML=false) />",
            "    </cffunction>",
            "",
            "    <cffunction name=\"search\">",
            "        <cfreturn application.lib.db.search(table_name='${2:table_name}', q=\"#url.q?:''#\") />",
            "    </cffunction>",
            "",
            "    <cffunction name=\"new\">",
            "        <cfreturn application.lib.db.getNewObject( table_name=\"${2:table_name}\"  ) />",
            "    </cffunction>",
            "",
            "    <cffunction name=\"save\">",
            "        <cfreturn application.lib.db.save(",
            "            table_name = \"${2:table_name}\",",
            "            data = request.data",
            "        ) />",
            "    </cffunction>",
            "",
            "    <cffunction name=\"delete\">",
            "        <cfreturn application.lib.db.delete(table_name=\"${2:table_name}\", id=\"#url.id#\") />",
            "    </cffunction>",
            "",
            "    <cffunction name=\"get\">",
            "        <cf_layout_default>",
            "            ",
            "            ",
            "            ",
            "        </cf_layout_default>",
            "    </cffunction>",
            "",
            "</cfcomponent>"
          ],
          "description": "Create a new route"
        },

        "endpoint.get": {
    "prefix": "endpoint.get",
    "description": "Creates a full admin endpoint with Alpine.js and Bootstrap",
    "body": [
      "<!--- LLM Script: update get() to handle @table, fields: a,b,c --->",
      "<cffunction name=\"get\" output=\"true\">",
      "    <cf_layout_default>",
      "        <cfoutput>",
      "",
      "        <style>",
      "        @media (min-width: 768px) {",
      "            .md-filter-container {",
      "                width: 0;",
      "                min-width: 260px;",
      "            }",
      "        }",
      "        </style>",
      "",
      "        <div id=\"moopa_admin\" x-data=\"moopa_admin\">",
      "            <div class=\"d-flex flex-column flex-md-row align-items-md-start\">",
      "                <div class=\"overflow-hidden d-flex mb-3 mb-md-0 me-md-4 md-filter-container\">",
      "                    <div class=\"card w-100\">",
      "                        <div class=\"card-body\">",
      "                            <cf_input_text label=\"\" model=\"filters.term\" modifiers=\".debounce\" placeholder=\"Search\" />",
      "                            <button type=\"button\" class=\"btn btn-outline-primary\" @click=\"handleResetFilter\">Reset</button>",
      "                        </div>",
      "                    </div>",
      "                </div>",
      "",
      "                <div class=\"flex-fill\">",
      "                    <div class=\"card\">",
      "                        <div class=\"card-header\">",
      "                            <div class=\"d-inline-flex align-items-center justify-content-between w-100\">",
      "                                <div class=\"d-flex align-items-center\">",
      "                                    <h5 class=\"card-title text-nowrap m-0\">\${1:table_name}</h5>",
      "                                    <div class=\"ms-2 text-muted\" x-show=\"action_status != ''\">",
      "                                        <i class=\"fat fa-cog fa-spin\"></i>",
      "                                        <span class=\"\" x-text=\"action_status\"></span>",
      "                                    </div>",
      "                                </div>",
      "                                <div class=\"card-actions float-md-end\">",
      "                                    <button x-button=\"handleAddNew()\" type=\"button\" class=\"btn btn-primary\" title=\"Add New \${1:table_name}\"><i class=\"fat fa-fw fa-plus\"></i> Add New</button>",
      "                                </div>",
      "                            </div>",
      "                        </div>",
      "",
      "                        <template x-if=\"true\">",
      "                            <table class=\"table table-sm table-hover\" style=\"table-layout: fixed;\">",
      "                            <tbody>",
      "                                <template x-for=\"(item, index) in records\" :key=\"item.id\">",
      "                                    <tr @click=\"handleSelect(item)\" role=\"button\">",
      "                                        <td class=\"align-top\" x-text=\"item.name\"></td>",
      "                                        <td class=\"align-top\" x-text=\"item.description\"></td>",
      "                                        <td style=\"width: 50px;\">",
      "                                            <button class=\"btn btn-outline-danger border-0\" @click.stop=\"openModalDeleteConfirmation(item)\" >",
      "                                                <i class=\"fat fa-trash\" ></i>",
      "                                            </button>",
      "                                        </td>",
      "                                    </tr >",
      "                                </template>",
      "                            </tbody>",
      "                            </table>",
      "                        </template>",
      "",
      "                        <template x-if=\"true\">",
      "                            <div x-show=\"action_status === '' && !records.length\" class=\"card-body\">",
      "                                <div class=\"alert alert-primary\" role=\"alert\">",
      "                                    <div class=\"alert-message\">",
      "                                        No Records match the filter",
      "                                    </div>",
      "                                </div>",
      "                            </div>",
      "                        </template>",
      "                    </div>",
      "                </div>",
      "            </div>",
      "",
      "            <cf_modal id=\"editModal\" title=\"Edit\" size=\"modal-lg\">",
      "                <cf_fields table_name=\"\${1:table_name}\" fields=\"\${2:fields}\" />",
      "                <cf_fragment name=\"actions\">",
      "                    <button x-button=\"handleSave()\" class=\"btn btn-primary\"><i class=\"fat fa-fw fa-save\"></i> Save</button>",
      "                </cf_fragment>",
      "            </cf_modal>",
      "",
      "            <cf_modal id=\"deleteConfirmationModal\" title=\"Delete Confirmation\" closeButtonText=\"Cancel\" size=\"modal-sm\">",
      "                <div class=\"text-center\">",
      "                    <i class=\"fal fa-light-emergency-on fa-3x text-danger\"></i>",
      "                    <h3>Delete: <span x-text=\"current_record.name\"></span></h3>",
      "                    <p> Warning: This cannot be undone.</p>",
      "                </div>",
      "                <cf_fragment name=\"actions\">",
      "                    <button x-button=\"handleDelete()\" class=\"btn btn-danger\"><i class=\"fat fa-fw fa-trash\"></i> Yes, Delete Please</button>",
      "                </cf_fragment>",
      "            </cf_modal>",
      "        </div>",
      "        </cfoutput>",
      "",
      "        <script>",
      "        document.addEventListener('alpine:init', () => {",
      "            Alpine.data('moopa_admin', () => ({",
      "                action_status: '',",
      "                error_messages: [],",
      "                filters: {},",
      "                records: [],",
      "                current_record: {},",
      "",
      "                init()  {",
      "                    this.handleResetFilter();",
      "                    this.handleLoad();",
      "                    this.setupEventListeners();",
      "                },",
      "",
      "                setupEventListeners() {",
      "                    this.$el.addEventListener('moo:updated', (event) => {",
      "                        const { path, oldValue, newValue } = event.detail;",
      "                        if (path.startsWith('filters.')) {",
      "                            this.handleLoad();",
      "                        }",
      "                    });",
      "                },",
      "",
      "                handleResetFilter(el) {",
      "                    this.filters = {",
      "                        term: ''",
      "                    }",
      "                },",
      "",
      "                async handleLoad() {",
      "                    this.action_status = 'loading...';",
      "",
      "                    this.records = await fetchData({",
      "                        endpoint: 'search',",
      "                        q: this.filters.term,",
      "                    });",
      "",
      "                    this.action_status = '';",
      "                },",
      "",
      "                async handleSave() {",
      "                    this.action_status = 'saving...'",
      "                    ",
      "                    await fetchData({",
      "                        endpoint: 'save',",
      "                        body: this.current_record,",
      "                    });",
      "",
      "                    this.action_status = ''",
      "",
      "                    this.handleLoad()",
      "                    this.current_record = {}",
      "                    bootstrap.Modal.getInstance(this.$refs.editModal).hide()",
      "                },",
      "",
      "                async handleAddNew() {",
      "                    this.action_status = 'new...';",
      "",
      "                    this.current_record = await fetchData({",
      "                        endpoint: 'new',",
      "                    });",
      "",
      "                    this.action_status = ''",
      "",
      "                    bootstrap.Modal.getInstance(this.$refs.editModal).show()",
      "                },",
      "",
      "                handleSelect(item) {",
      "                    this.current_record = JSON.parse(JSON.stringify(item))",
      "",
      "                    bootstrap.Modal.getInstance(this.$refs.editModal).show()",
      "                },",
      "",
      "                openModalDeleteConfirmation(current_record) {",
      "                    this.current_record = current_record",
      "",
      "                    bootstrap.Modal.getInstance(this.$refs.deleteConfirmationModal).show()",
      "                },",
      "",
      "                async handleDelete() {",
      "                    this.action_status = 'saving...'",
      "",
      "                    await fetchData({",
      "                        endpoint: 'delete',",
      "                        id: this.current_record.id,",
      "                    });",
      "                    ",
      "                    this.current_record = {}",
      "",
      "                    this.handleLoad()",
      "                    ",
      "                    bootstrap.Modal.getInstance(this.$refs.deleteConfirmationModal).hide()",
      "                    ",
      "                    this.action_status = ''",
      "                },",
      "            }))",
      "        })",
      "        </script>",
      "",
      "    </cf_layout_default>",
      "</cffunction>"
    ]
  },

        "schema": {
          "prefix": "schema",
          "body": [
            "<cfcomponent>",
            "",
            "    <cffunction name=\"init\">",
            "",
            "        <cfset this.definition =",
            "        {",
            "            \"title\": \"$1\",",
            "            \"title_plural\": \"$1s\",",
            "            \"label_generation_expression\": \"COALESCE(name::text, '')\",",
            "            \"order_by\": \"name asc\",",
            "            \"searchable_fields\": \"name\",",
            "            \"fields\": {",
            "                \"foreign_id\": {\"type\" : \"uuid\", \"foreign_key_table\" : \"property_account\", \"foreign_key_onDelete\" : \"NO ACTION\"},",
            "                \"seq\": { \"type\": \"int2\", \"default\":99 },",
            "                \"name\": { },",
            "                \"address\": { \"type\": \"jsonb\", \"html\":  { \"type\": \"input_address\" } }",
            "            }",
            "          }",
            "",
            "        />",
            "",
            "        <cfreturn this>",
            "    </cffunction>",
            "</cfcomponent>"
          ],
          "description": "New SCHEMA component"
        },
        "thread": {
          "prefix": "thread",
          "body": [
            "<cfthread>",
            "    <cftry>",
            "",
            "        <!--- Do Something --->",
            "    ",
            "        <cfcatch type=\"any\">",
            "            <cfset application.lib.core.logError(Exception=\"#cfcatch#\") />",
            "            <cfabort>",
            "        </cfcatch>",
            "    </cftry>",
            "",
            "</cfthread>"
          ],
          "description": "thread"
        },

        "Moo Updated Event Listener": {
            "prefix": "listen:moo:updated",
            "body": [
            "this.$el.addEventListener('moo:updated', (event) => {",
            "\tconst { path, oldValue, newValue } = event.detail;",
            "",
            "\tif (path.startsWith('$1.')) {",
            "\t\tthis.handleAutoSave();",
            "\t}",
            "});"
            ],
            "description": "Moo framework updated event listener"
        },
        "Moo Updated Event Listener with Custom Logic": {
            "prefix": "listen:moo:updated-custom",
            "body": [
            "this.$el.addEventListener('moo:updated', (event) => {",
            "\tconst { path, oldValue, newValue } = event.detail;",
            "",
            "\tswitch (path) {",
            "\t\tcase '$1':",
            "\t\t\t$2",
            "\t\t\tbreak;",
            "\t\tcase '$3':",
            "\t\t\t$4",
            "\t\t\tbreak;",
            "\t\tdefault:",
            "\t\t\tif (path.startsWith('$5.')) {",
            "\t\t\t\tthis.handleAutoSave();",
            "\t\t\t}",
            "\t}",
            "});"
            ],
            "description": "Moo framework updated event listener with custom path logic"
        },
        "Moo Updating Event Listener": {
            "prefix": "listen:moo:updating",
            "body": [
            "this.$el.addEventListener('moo:updating', (event) => {",
            "\tconst { path, oldValue, newValue } = event.detail;",
            "",
            "\tif (path.startsWith('$1.')) {",
            "\t\tthis.handleAutoSave();",
            "\t}",
            "});"
            ],
            "description": "Moo framework updating event listener (before value changes)"
        },
      }
